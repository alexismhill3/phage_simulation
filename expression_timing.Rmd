---
title: "Expression Timing"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
library(readr)
library(dplyr)
library(ggplot2)
library(cowplot)
library(ggrepel)
```

## Tabasco with mRNA degradation

Kosuri, et al fit mRNA degradation rates to their own mRNA count data. I used their final fit parameters to run tabasco and generate the following plots:

### mRNA

```{r tabasco_mrnadeg}

sim <- read_csv("data/tabasco_runs/091815_B_avg.csv")

genes <- c("RNA: gp10A", 
            "RNA: gp9", 
            "RNA: gp8", 
            "RNA: gp7", 
            "RNA: gp11", 
            "RNA: gp12", 
            "RNA: gp13", 
            "RNA: gp14", 
            "RNA: gp15")

ggplot(sim %>% filter(tabasco_id %in% genes, time <= 300), aes(x = time, y = sim_count, color = tabasco_id)) + 
  geom_line() + 
  coord_cartesian(xlim = c(200, 320), ylim = c(0, 600)) + 
  geom_text_repel(
    data = filter(sim, tabasco_id %in% genes, time == 300),
    aes(label = tabasco_id),
    size = 4,
    nudge_x = 10,
    fontface = "bold",
    point.padding = unit(0.3, "lines")
  ) +
  theme(legend.position = "none")

```

### Proteins

```{r tabasco_mrnadeg_prot}

prots <- c("gp10A", 
            "gp9", 
            "gp8", 
            "gp7", 
            "gp11", 
            "gp12", 
            "gp13", 
            "gp14", 
            "gp15")

ggplot(sim %>% filter(tabasco_id %in% prots, time <= 300), aes(x = time, y = sim_count, color = tabasco_id, group = tabasco_id)) + 
  geom_line() + 
  coord_cartesian(xlim = c(200, 320), ylim = c(0, 900)) + 
  geom_text_repel(
    data = filter(sim, tabasco_id %in% prots, time == 300),
    aes(label = tabasco_id),
    size = 4,
    nudge_x = 6,
    fontface = "bold",
    point.padding = unit(0.3, "lines")
  ) +
  theme(legend.position = "none")

```

## Tabasco without mRNA degradation

Initially, Kosuri, et al did not include mRNA degradation in their model. I used that initial model to run tabasco and generate the following plot:

### mRNA

```{r tabasco_no_mrnadeg}

sim <- read_csv("data/tabasco_runs/092115_A_avg.csv")

ggplot(sim %>% filter(tabasco_id %in% genes, time <= 300), aes(x = time, y = sim_count, color = tabasco_id, group = tabasco_id)) + 
  geom_line() + 
  coord_cartesian(xlim = c(200, 320), ylim = c(0, 450)) + 
  geom_text_repel(
    data = filter(sim, tabasco_id %in% genes, time == 300),
    aes(label = tabasco_id),
    size = 4,
    nudge_x = 10,
    fontface = "bold",
    point.padding = unit(0.3, "lines")
  ) +
  theme(legend.position = "none")

```

The model without mRNA degradation has lower class 3 transcript abundances than the model with mRNA degradation. I haven't figured out why.

### Proteins

```{r tabasco_no_mrnadeg_prot}

ggplot(sim %>% filter(tabasco_id %in% prots, time <= 300), aes(x = time, y = sim_count, color = tabasco_id, group = tabasco_id)) + 
  geom_line() + 
  coord_cartesian(xlim = c(200, 320), ylim = c(0, 800)) + 
  geom_text_repel(
    data = filter(sim, tabasco_id %in% prots, time == 300),
    aes(label = tabasco_id),
    size = 4,
    nudge_x = 6,
    fontface = "bold",
    point.padding = unit(0.3, "lines")
  ) +
  theme(legend.position = "none")
